@model IEnumerable<Your_Money.Models.Usuario>

@using System.Net.Http
@using System.Text.Json
@using System.Globalization

@{
    ViewData["Title"] = "Minha Conta";
    var lancamentosMes = ViewBag.LancamentosMes as Dictionary<int, (int receitasMes, int despesasMes)>;
}

@{
    // Criando uma instância do HttpClient para fazer a requisição HTTP
    var httpClient = new HttpClient();

    var response = await httpClient.GetAsync("https://economia.awesomeapi.com.br/last/USD-BRL,EUR-BRL,BTC-BRL");

    var responseContent = await response.Content.ReadAsStringAsync();

    var jsonOptions = new JsonSerializerOptions
            {
                PropertyNameCaseInsensitive = true
            };

    var apiData = JsonSerializer.Deserialize<Dictionary<string, Dictionary<string, dynamic>>>(responseContent, jsonOptions);

    var usdValue = decimal.Parse(apiData["USDBRL"]["bid"].ToString(), CultureInfo.InvariantCulture);
    var eurValue = decimal.Parse(apiData["EURBRL"]["bid"].ToString(), CultureInfo.InvariantCulture);
    var btcValue = decimal.Parse(apiData["BTCBRL"]["bid"].ToString(), CultureInfo.InvariantCulture);
}

<body style="background-image: url(/blue1.png);width:100%;max-height:contain;">

    <nav>
        <ol class="breadcrumb p-0 pt-0 pb-3" style="background: white;">
            <li class="breadcrumb-item"><a asp-area="" asp-controller="Usuarios" asp-action="Index">Home</a></li>
            <li class="breadcrumb-item active" aria-current="page">Minha Conta</li>
            <marquee direction="left" style="background-color:aliceblue;padding-top:5px;padding-bottom:5px;">
                <span class="text-info">Dólar -&gt;</span> @usdValue.ToString("C", CultureInfo.GetCultureInfo("pt-BR")) &nbsp;|&nbsp;
                <span class="text-info">Euro -&gt;</span> @eurValue.ToString("C", CultureInfo.GetCultureInfo("pt-BR")) &nbsp;|&nbsp;
                <span class="text-info">Bitcoin -&gt;</span> @btcValue.ToString("C", CultureInfo.GetCultureInfo("pt-BR")) &nbsp;|&nbsp;
                <h7 id="cotation"><h7 class="text-info" style="font-style:italic;padding-left:30px;">última atualização à 30 segundos</h7>
            </marquee>
        </ol>
    </nav>

    <div class="container-fluid">
        <div class="row">
            <div class="col-7">
                <h2 style="color:darkblue;">Minha Conta</h2>

                <h6 style="color:black;">Saldo total da conta: <b>@ViewBag.SaldoTotal.ToString("C")</b></h6>
            </div>
            <div class="col">
                <form asp-action="Index" method="get" class="form-row">
                    <div class="form-group">
                        <label class="control-label" style="color:darkblue;"><b>Mês</b></label>
                        <select name="mes" class="form-control shadow-sm" required style="color:darkblue;">
                            <option value="@ViewBag.MesAtual">Mês Atual</option>
                            <option value="1">Janeiro</option>
                            <option value="2">Fevereiro</option>
                            <option value="3">Março</option>
                            <option value="4">Abril</option>
                            <option value="5">Maio</option>
                            <option value="6">Junho</option>
                            <option value="7">Julho</option>
                            <option value="8">Agosto</option>
                            <option value="9">Setembro</option>
                            <option value="10">Outubro</option>
                            <option value="11">Novembro</option>
                            <option value="12">Dezembro</option>
                        </select>
                    </div>
                    <div class="col-4">
                        <div class="form-group">
                            <label class="control-label" style="color:darkblue;"><b>Ano</b></label>
                            <input type="number" name="ano" class="form-control shadow-sm" required style="color:darkblue;" Placeholder="Digite o ano" value="@ViewBag.AnoAtual" />
                        </div>
                    </div>
                    <div class="col">
                        <div class="form-group">
                            <button class="btn btn-primary" style="margin-top:32px;">Pesquisar</button>
                        </div>
                    </div>
                </form>
            </div>
        </div>
    </div>

    <hr>

    <div class="container-fluid pt-4 p-2 pb-5 text-center">
        <div class="row">
            <div class="col-3">
                <div class="card align-items-center shadow" style="border-start-start-radius:20px;border-start-end-radius:20px;border-end-start-radius:20px;border-end-end-radius:20px;">
                    <img src="~/user.png" alt="usuário" width="70%" style="padding-top:15%;">
                    <div class="card-body">
                        <p id="NameUser" class="card-text" style="color:darkblue"><h4>Olá, @User.Identity.Name</h4></p>
                    </div>
                    @foreach (var item in Model)
                    {
                        <div class="p-3 pb-5">
                            <a asp-action="Edit" asp-route-id="@item.Id" style="padding-right:5px;">
                                <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-pencil" viewBox="0 0 16 16">
                                    <path d="M12.146.146a.5.5 0 0 1 .708 0l3 3a.5.5 0 0 1 0 .708l-10 10a.5.5 0 0 1-.168.11l-5 2a.5.5 0 0 1-.65-.65l2-5a.5.5 0 0 1 .11-.168l10-10zM11.207 2.5 13.5 4.793 14.793 3.5 12.5 1.207 11.207 2.5zm1.586 3L10.5 3.207 4 9.707V10h.5a.5.5 0 0 1 .5.5v.5h.5a.5.5 0 0 1 .5.5v.5h.293l6.5-6.5zm-9.761 5.175-.106.106-1.528 3.821 3.821-1.528.106-.106A.5.5 0 0 1 5 12.5V12h-.5a.5.5 0 0 1-.5-.5V11h-.5a.5.5 0 0 1-.468-.325z" />
                                </svg>
                            </a><h7 class="text-info"> | </h7>
                            <a asp-action="Delete" asp-route-id="@item.Id" style="padding-left:5px;">
                                <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-trash" viewBox="0 0 16 16">
                                    <path d="M5.5 5.5A.5.5 0 0 1 6 6v6a.5.5 0 0 1-1 0V6a.5.5 0 0 1 .5-.5Zm2.5 0a.5.5 0 0 1 .5.5v6a.5.5 0 0 1-1 0V6a.5.5 0 0 1 .5-.5Zm3 .5a.5.5 0 0 0-1 0v6a.5.5 0 0 0 1 0V6Z" />
                                    <path d="M14.5 3a1 1 0 0 1-1 1H13v9a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V4h-.5a1 1 0 0 1-1-1V2a1 1 0 0 1 1-1H6a1 1 0 0 1 1-1h2a1 1 0 0 1 1 1h3.5a1 1 0 0 1 1 1v1ZM4.118 4 4 4.059V13a1 1 0 0 0 1 1h6a1 1 0 0 0 1-1V4.059L11.882 4H4.118ZM2.5 3h11V2h-11v1Z" />
                            </a>
                        </div>
                    }
                </div>
            </div>

            <div class="col-3 text-center">
                <div class="card shadow" style="border-start-start-radius:20px;border-start-end-radius:20px;border-end-start-radius:20px;border-end-end-radius:20px;">
                    <div class="card-body" style="background-color:lightgreen;border-start-start-radius:20px;border-start-end-radius:20px;">
                        <h4><b style="color:green;text-shadow:black;"><p style="margin-top:15px;">Receitas</p></b></h4>
                    </div>
                    <div class="pt-5 pb-5" style="color:green">
                        <h2><b>@ViewBag.ValorReceitas.ToString("C")</b></h2>
                        <img onclick="location=HTMLHRElement='Lancamentos/Create'" src="~/revenue.png" width="50%" style="padding-top: 1rem;cursor:pointer;">
                    </div>
                    <div style="color:green;padding:5px;"><h6>Clique no "+" para adicionar uma Receita</h6></div>
                </div>
            </div>

            <div class="col-3 text-center">
                <div class="card shadow" style="border-start-start-radius:20px;border-start-end-radius:20px;border-end-start-radius:20px;border-end-end-radius:20px;">
                    <div class="card-body" style="background-color:indianred;border-start-start-radius:20px;border-start-end-radius:20px;">
                        <h4><b style="color:white;"><p style="margin-top:15px;">Despesas</p></b></h4>
                    </div>
                    <div class="pt-5 pb-5" style="color:darkred">
                        <h2><b>@ViewBag.ValorDespesas.ToString("C")</b></h2>
                        <img onclick="location=HTMLHRElement='Lancamentos/Create'" src="~/expense.png" width="50%" style="padding-top: 1rem;cursor:pointer;">
                    </div>
                    <div style="color:darkred;padding:5px;"><h6>Clique no "+" para adicionar uma Despesa</h6></div>
                </div>
            </div>

            <div class="col-3 text-center">
                <div class="card shadow" style="border-start-start-radius:20px;border-start-end-radius:20px;border-end-start-radius:20px;border-end-end-radius:20px;">
                    <div class="card-body" style="background-color:lightgray;border-start-start-radius:20px;border-start-end-radius:20px;">
                        <h4><b style="color:black;text-shadow:black;padding-bottom:0px;">Saldo do mês</b></h4><h7 class="p-0 pt-0 pb-0">selecionado</h7>
                    </div>
                    <div class="pt-5 pb-5" style="color:darkslategray;">
                        <h2><b>@ViewBag.Saldo.ToString("C")</b></h2>
                        <img onclick="location=HTMLHRElement='Lancamentos/Create'" src="~/saldo.png" width="52%" style="padding-top: 1rem">
                    </div>
                </div>
            </div>
        </div>
    </div>

    <hr style="padding-top:10px;padding-bottom:10px;">

    <style>
        .marker {
            background-color: green;
            width: 5px;
            height: 100%;
            position: absolute;
            top: 0;
            left: 0;
        }

        .marker1 {
            background-color: red;
            width: 5px;
            height: 100%;
            position: absolute;
            top: 0;
            left: 0;
        }
    </style>

    <div class="container">
        <h4 style="text-align:center;padding-bottom:10px;color:darkblue;">Em aberto para os próximos 15 dias<hr /></h4>
        <div class="row">
            <div class="col-sm-6">
                <div class="card shadow" style="border-start-end-radius:20px;border-end-end-radius:20px;">
                    <div class="card-body" style="background-color:white;border-start-end-radius:20px;border-end-end-radius:20px;">
                        <h5 style="color:darkgreen;text-align:center;padding-left:5px;">
                            <svg xmlns="http://www.w3.org/2000/svg" width="30" height="30" fill="currentColor" class="bi bi-cash-coin" viewBox="0 0 16 16">
                                <path fill-rule="evenodd" d="M11 15a4 4 0 1 0 0-8 4 4 0 0 0 0 8zm5-4a5 5 0 1 1-10 0 5 5 0 0 1 10 0z" />
                                <path d="M9.438 11.944c.047.596.518 1.06 1.363 1.116v.44h.375v-.443c.875-.061 1.386-.529 1.386-1.207 0-.618-.39-.936-1.09-1.1l-.296-.07v-1.2c.376.043.614.248.671.532h.658c-.047-.575-.54-1.024-1.329-1.073V8.5h-.375v.45c-.747.073-1.255.522-1.255 1.158 0 .562.378.92 1.007 1.066l.248.061v1.272c-.384-.058-.639-.27-.696-.563h-.668zm1.36-1.354c-.369-.085-.569-.26-.569-.522 0-.294.216-.514.572-.578v1.1h-.003zm.432.746c.449.104.655.272.655.569 0 .339-.257.571-.709.614v-1.195l.054.012z" />
                                <path d="M1 0a1 1 0 0 0-1 1v8a1 1 0 0 0 1 1h4.083c.058-.344.145-.678.258-1H3a2 2 0 0 0-2-2V3a2 2 0 0 0 2-2h10a2 2 0 0 0 2 2v3.528c.38.34.717.728 1 1.154V1a1 1 0 0 0-1-1H1z" />
                                <path d="M9.998 5.083 10 5a2 2 0 1 0-3.132 1.65 5.982 5.982 0 0 1 3.13-1.567z" />
                            </svg>
                            Valores à Receber
                        </h5>

                        <table class="table" style="font-size:8px;text-size-adjust:auto;">
                            <thead style="text-align:center">
                                <tr style="background-color:aliceblue;font-size:8px;text-size-adjust:auto;">
                                    <th scope="col">Classificação</th>
                                    <th scope="col">Valor</th>
                                    <th scope="col">Vencimento</th>
                                    <th scope="col">Descrição</th>
                                </tr>
                            </thead>
                            <tbody style="text-align:center;font-size:8px;text-size-adjust:auto;">
                                <tr>
                                    <td>Salário</td>
                                    <td>R$ 3.500,00</td>
                                    <td>10/06/2023</td>
                                    <td>Salário Junho</td>
                                </tr>
                                <tr>
                                    <td>Investimento</td>
                                    <td>R$ 500,00</td>
                                    <td>20/06/2023</td>
                                    <td>Rendimento</td>
                                </tr>
                            </tbody>
                        </table>

                    </div>
                    <div class="marker"></div>
                </div>
            </div>
            <div class="col-sm-6">
                <div class="card shadow" style="border-start-end-radius:20px;border-end-end-radius:20px;">
                    <div class="card-body" style="background-color:white;border-start-end-radius:20px;border-end-end-radius:20px;">
                        <h5 style="color:darkred;text-align:center;padding-left:5px;">
                            <svg xmlns="http://www.w3.org/2000/svg" width="30" height="30" fill="currentColor" class="bi bi-receipt" viewBox="0 0 16 16">
                                <path d="M1.92.506a.5.5 0 0 1 .434.14L3 1.293l.646-.647a.5.5 0 0 1 .708 0L5 1.293l.646-.647a.5.5 0 0 1 .708 0L7 1.293l.646-.647a.5.5 0 0 1 .708 0L9 1.293l.646-.647a.5.5 0 0 1 .708 0l.646.647.646-.647a.5.5 0 0 1 .708 0l.646.647.646-.647a.5.5 0 0 1 .801.13l.5 1A.5.5 0 0 1 15 2v12a.5.5 0 0 1-.053.224l-.5 1a.5.5 0 0 1-.8.13L13 14.707l-.646.647a.5.5 0 0 1-.708 0L11 14.707l-.646.647a.5.5 0 0 1-.708 0L9 14.707l-.646.647a.5.5 0 0 1-.708 0L7 14.707l-.646.647a.5.5 0 0 1-.708 0L5 14.707l-.646.647a.5.5 0 0 1-.708 0L3 14.707l-.646.647a.5.5 0 0 1-.801-.13l-.5-1A.5.5 0 0 1 1 14V2a.5.5 0 0 1 .053-.224l.5-1a.5.5 0 0 1 .367-.27zm.217 1.338L2 2.118v11.764l.137.274.51-.51a.5.5 0 0 1 .707 0l.646.647.646-.646a.5.5 0 0 1 .708 0l.646.646.646-.646a.5.5 0 0 1 .708 0l.646.646.646-.646a.5.5 0 0 1 .708 0l.646.646.646-.646a.5.5 0 0 1 .708 0l.646.646.646-.646a.5.5 0 0 1 .708 0l.509.509.137-.274V2.118l-.137-.274-.51.51a.5.5 0 0 1-.707 0L12 1.707l-.646.647a.5.5 0 0 1-.708 0L10 1.707l-.646.647a.5.5 0 0 1-.708 0L8 1.707l-.646.647a.5.5 0 0 1-.708 0L6 1.707l-.646.647a.5.5 0 0 1-.708 0L4 1.707l-.646.647a.5.5 0 0 1-.708 0l-.509-.51z" />
                                <path d="M3 4.5a.5.5 0 0 1 .5-.5h6a.5.5 0 1 1 0 1h-6a.5.5 0 0 1-.5-.5zm0 2a.5.5 0 0 1 .5-.5h6a.5.5 0 1 1 0 1h-6a.5.5 0 0 1-.5-.5zm0 2a.5.5 0 0 1 .5-.5h6a.5.5 0 1 1 0 1h-6a.5.5 0 0 1-.5-.5zm0 2a.5.5 0 0 1 .5-.5h6a.5.5 0 0 1 0 1h-6a.5.5 0 0 1-.5-.5zm8-6a.5.5 0 0 1 .5-.5h1a.5.5 0 0 1 0 1h-1a.5.5 0 0 1-.5-.5zm0 2a.5.5 0 0 1 .5-.5h1a.5.5 0 0 1 0 1h-1a.5.5 0 0 1-.5-.5zm0 2a.5.5 0 0 1 .5-.5h1a.5.5 0 0 1 0 1h-1a.5.5 0 0 1-.5-.5zm0 2a.5.5 0 0 1 .5-.5h1a.5.5 0 0 1 0 1h-1a.5.5 0 0 1-.5-.5z" />
                            </svg>
                            Valores à Pagar
                        </h5>

                        <table class="table" style="font-size:8px;text-size-adjust:auto;">
                            <thead style="text-align:center">
                                <tr style="background-color:aliceblue;text-size-adjust:auto;">
                                    <th scope="col">Classificação</th>
                                    <th scope="col">Valor</th>
                                    <th scope="col">Vencimento</th>
                                    <th scope="col">Descrição</th>
                                </tr>
                            </thead>
                            <tbody style="text-align:center;font-size:8px;">
                                <tr >
                                    <td>Aluguel</td>
                                    <td>R$ 1.500,00</td>
                                    <td>10/06/2023</td>
                                    <td>Aluguel Junho</td>
                                </tr>
                                <tr>
                                    <td>Saúde</td>
                                    <td>R$ 450,00</td>
                                    <td>30/06/2023</td>
                                    <td>Plano de Saúde</td>
                                </tr>
                                <tr>
                                    <td>Impostos</td>
                                    <td>R$ 320,00</td>
                                    <td>15/06/2023</td>
                                    <td>IPTU</td>
                                </tr>
                                <tr>
                                    <td>Moradia</td>
                                    <td>R$ 230,00</td>
                                    <td>17/06/2023</td>
                                    <td>Energia Elétrica</td>
                                </tr>
                            </tbody>
                        </table>

                    </div>
                    <div class="marker1"></div>
                </div>
            </div>

        </div>
    </div>

</body>